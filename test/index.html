<!DOCTYPE html>
<html>
	<head>
		<title>Sculpy models test</title>
		<meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
		<script src="ender.min.js" type="text/javascript"></script>
		<script src="../sculpy.js" type="text/javascript"></script>
	</head>
	<body>
	
<script type="text/javascript">
	var bean = require('bean');

	var Foo = Sculpy.Model.extend({
		properties: {
			name: ['string', ''],
			swizzle: ['string', 'stick'],
			count: ['number', 0],
		},
		calculated: ['report', ],
		initialize: function()
		{
			this.watch(this, 'change:name', this.updateCalculated);
			this.watch(this, 'change:count', this.updateCalculated);
		},
	});
	
	Foo.prototype.updateCalculated = function()
	{
		this.report(this.name() + ' has '+this.count() + ' ' + this.swizzle());
		console.log(this.report());
	};

	var bleat = new Foo();
	console.log(bleat);
	
	bleat.name('can haz name');
	console.log(bleat.name());
	console.log(bleat.swizzle());
	bleat.swizzle('sparkle');
	console.log(bleat.swizzle());
	bleat.count(bleat.count() + 2);
	
	bleat.update({name: 'my new name', swizzle: 'no more swizz'}, false);
	console.log(bleat.toJSON());

	var Bar = Sculpy.Model.extend({
		properties: {
			created: ['date', undefined],
			count: ['number', 0],
			mine: ['boolean', true]
		},
		urlroot: '/bars'
	});
	
	var bar = new Bar();
	bar.created("invalid");
	console.log(bar.mine());
	console.log(bar.valid());
	console.log(bar.errors);
	

</script>
	
	</body>
</html>