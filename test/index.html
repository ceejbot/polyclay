<!DOCTYPE html>
<html>
	<head>
		<title>Sculpy models test</title>
		<meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
		<script src="jquery-1.7.1.min.js" type="text/javascript"></script>
		<script src="ICanHaz.min.js" type="text/javascript"></script>
		<script src="ender.js" type="text/javascript"></script>
		<script src="../sculpy.js" type="text/javascript"></script>
	</head>
	<body>
<h3>Single item!</h3>
<div id="putfoohere"></div>

<h3>Collection!</h3>
<div id="collectionhere"></div>
	
<script id="foobox" type="text/html">
<p>
<b>Name:</b> {{name}}<br />
<b>Swizzling:</b> {{swizzle}}<br />
<b>Count:</b> {{count}}<br />
<b>Report:</b> {{report}}
</p>
</script>

<script type="text/javascript">
	var Foo = Sculpy.Model.extend({
		properties: {
			name: '',
			swizzle: 'stick',
			count: 0,
		},
		calculated: ['report', ],
		template: 'foobox',
	},
	{
		initialize: function(shoutit)
		{
			console.log(shoutit);
			this.watch(this, 'change:name', this.updateCalculated);
			this.watch(this, 'change:count', this.updateCalculated);
		},
		updateCalculated: function()
		{
			this.report(this.name() + ' has '+this.count() + ' ' + this.swizzle());
			console.log(this.report());
		},
	});

	var bleat = new Foo('yippee!');
	console.log(bleat);
	
	bleat.name('can haz name');
	console.log(bleat.name());
	console.log(bleat.report());
	console.log(bleat.swizzle());
	bleat.swizzle('sparkle');
	console.log(bleat.swizzle());
	console.log(bleat.report());
	bleat.count(bleat.count() + 2);
	
	bleat.update({name: 'my new name', swizzle: 'sparklestick'}, false);	
	
	var FooCollection = Sculpy.Collection.extend({
		model: Foo,
		urlroot: '/foos',
	},
	{
		initialize: function(element)
		{
			this.element(element);
			this.watch(this, 'reset', this.render);
			this.watch(this, 'add', this.render);
		},
	});
	
	$(document).ready(function()
	{
		$('#putfoohere').append(bleat.render());
		
		var listthing = new FooCollection('#collectionhere');
		listthing.push(bleat);
		
		var another = new Foo();
		another.name('Another One');
		another.swizzle('swizzlesticks galore');
		another.count(7);
		
		listthing.push(another);
	});
	
</script>
	
	</body>
</html>